-- Semantic rule X.3.(24)

-- $Id$

package example_sr_X3_24
public

data dt
end dt;

thread th
  features
    p1 : in event data port dt;
    p2 : in event data port dt;
    m : out event data port dt;
end th;

thread implementation th.good
subcomponents
  x1 : data dt;
  x2 : data dt;
properties
  Dispatch_Trigger => reference (p1);
  Dispatch_Trigger => reference (p2);
annex behavior_specification {**
  states
    s0 : initial state;
    comp : final state;
    next1 : complete state;
    next2 : complete state;
    
  transitions
    s0 -[ ]-> next1 { x1 := p1 };
    
    -- Error p1 must be referenced as dispatch condition because
    -- it is specified in the AADL Dispatch_Trigger property
    next1 -[on dispatch p2]-> comp { x2 := p2 };
    next2 -[on dispatch p1]-> comp { x2 := p2 };
**};
end th.good;

thread implementation th.error
subcomponents
  x1 : data dt;
  x2 : data dt;
properties
  Dispatch_Trigger => reference (p1);
  Dispatch_Trigger => reference (p2);
annex behavior_specification {**
  states
    s0 : initial state;
    comp : final state;
    next1 : complete state;
    next2 : complete state;
    
  transitions
    s0 -[ ]-> next1 { x1 := p1 };
    
    -- Error p1 must be referenced as dispatch condition because
    -- it is specified in the AADL Dispatch_Trigger property
    next1 -[on dispatch p2]-> comp { x2 := p2 };
**};
end th.error;

system s
end s;

processor cpu
end cpu;

process proc
end proc;

process implementation proc.impl
subcomponents
	th : thread th.good;
	
end proc.impl;

system implementation s.impl
subcomponents
 p : process proc;
 c : processor cpu;
 
properties
  Actual_Processor_Binding => reference (c) applies to p;  
end s.impl;

end example_sr_X3_24;